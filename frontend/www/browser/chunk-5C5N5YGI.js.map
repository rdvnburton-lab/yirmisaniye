{
  "version": 3,
  "sources": ["src/app/services/quiz.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable, of } from 'rxjs';\r\nimport { QuizQuestionsResponse } from '../models/quiz.model';\r\n\r\nexport interface Subject {\r\n  subject_id: number;\r\n  subject_name: string;\r\n  icon?: string;\r\n}\r\n\r\nexport interface Topic {\r\n  topic_id: number;\r\n  topic_name: string;\r\n  icon?: string;\r\n}\r\n\r\nexport interface SubmitResponse {\r\n  score: number;\r\n  total: number;\r\n  detailedResults: any[];\r\n  comboBonuses: number[];\r\n  new_total_points: number;\r\n}\r\n\r\nexport interface QuizHistory {\r\n  quiz_id: number;\r\n  difficulty: string;\r\n  created_at: string;\r\n  score: number;\r\n  total_questions: number;\r\n  subject_name: string;\r\n  topic_name: string;\r\n}\r\n\r\nexport interface QuizDetail {\r\n  log_id: number;\r\n  question_text: string;\r\n  user_answer: string;\r\n  correct_answer: string;\r\n  is_correct: boolean;\r\n  time_taken: number;\r\n}\r\n\r\nexport interface PreviousPerformanceEntry {\r\n  quiz_id: number;\r\n  created_at: string;\r\n  correct_count: number;\r\n  wrong_count: number;\r\n  topic_names: string;\r\n  topic_icons: string[]; // Yeni alan\r\n}\r\n\r\nexport interface PerformanceByDifficulty {\r\n  difficulty: 'easy' | 'medium' | 'hard';\r\n  total_answered: number;\r\n  correct_count: number;\r\n  total_points: number;\r\n}\r\n\r\nexport interface BestTopic {\r\n  topic_name: string;\r\n  subject_name: string;\r\n  subject_icon: string;\r\n  success_rate: number;\r\n}\r\n\r\nexport interface ProfileStats {\r\n  quizzes_completed: number;\r\n  total_score: number;\r\n  total_questions_answered: number;\r\n  total_correct_answers: number;\r\n  total_wrong_answers: number; // Eksik alan eklendi\r\n  average_score_per_quiz: number; // Eksik alan eklendi\r\n  overall_success_rate: number;\r\n  performance_over_time: { quiz_date: string; daily_score: number }[];\r\n  performance_by_difficulty: PerformanceByDifficulty[];\r\n  best_topics: BestTopic[];\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class QuizService {\r\n  // Nginx bu isteği backend'e yönlendirecek\r\n  private apiUrl = '/api/quiz';\r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  getSubjects(): Observable<Subject[]> {\r\n    return this.http.get<Subject[]>(`${this.apiUrl}/subjects`);\r\n  }\r\n\r\n  getTopics(subjectId: number): Observable<Topic[]> {\r\n    const params = new HttpParams().set('subjectId', subjectId.toString());\r\n    return this.http.get<Topic[]>(`${this.apiUrl}/topics`, { params });\r\n  }\r\n\r\n  /**\r\n   * Backend'den quiz sorularını getirir.\r\n   * Token, AuthInterceptor tarafından otomatik olarak eklenecektir.\r\n   */\r\n  getQuestions(subjectId: number, topicIds: number[], isTimed: boolean, difficulty: string): Observable<QuizQuestionsResponse> {\r\n    let params = new HttpParams()\r\n      .set('subjectId', subjectId.toString())\r\n      .set('isTimed', isTimed.toString())\r\n      .set('difficulty', difficulty)\r\n      .set('topicIds', topicIds.join(',')); // Diziyi virgülle ayrılmış string'e çevir\r\n    return this.http.get<QuizQuestionsResponse>(`${this.apiUrl}/questions`, { params });\r\n  }\r\n\r\n  /**\r\n   * Kullanıcının cevaplarını backend'e gönderir ve skoru alır.\r\n   * @param answers Kullanıcının cevapları\r\n   */\r\n  submitAnswers(quizId: number, answers: { questionId: number, optionId: number | null, timeTaken: number, attempts: number }[]): Observable<SubmitResponse> {\r\n    return this.http.post<SubmitResponse>(`${this.apiUrl}/submit`, { quizId, answers });\r\n  }\r\n\r\n  getQuizHistory(): Observable<QuizHistory[]> {\r\n    return this.http.get<QuizHistory[]>(`${this.apiUrl}/history`);\r\n  }\r\n\r\n  getQuizDetails(quizId: number): Observable<QuizDetail[]> {\r\n    return this.http.get<QuizDetail[]>(`${this.apiUrl}/history/${quizId}`);\r\n  }\r\n  getWrongTopicStats(): Observable<any> {\r\n    return this.http.get<any>(`${this.apiUrl}/stats/wrong-topics`);\r\n}\r\n\r\n  getLeaderboard(): Observable<any[]> {\r\n    return this.http.get<any[]>(`${this.apiUrl}/leaderboard`);\r\n  }\r\n\r\n  getProfileStats(): Observable<ProfileStats> {\r\n    return this.http.get<ProfileStats>(`${this.apiUrl}/profile-stats`);\r\n  }\r\n\r\n  getDailyChallenge(): Observable<any> {\r\n    return this.http.get<any>(`${this.apiUrl}/daily-challenge`);\r\n  }\r\n\r\n  getPreviousPerformance(subjectId: number, currentQuizId: number): Observable<PreviousPerformanceEntry[]> {\r\n    const params = new HttpParams()\r\n      .set('subjectId', subjectId.toString())\r\n      .set('currentQuizId', currentQuizId.toString());\r\n    return this.http.get<PreviousPerformanceEntry[]>(`${this.apiUrl}/previous-performance`, { params });\r\n  }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;AAmFM,IAAO,cAAP,MAAO,aAAW;EAIF;;EAFZ,SAAS;EAEjB,YAAoB,MAAgB;AAAhB,SAAA,OAAA;EAAoB;EAExC,cAAW;AACT,WAAO,KAAK,KAAK,IAAe,GAAG,KAAK,MAAM,WAAW;EAC3D;EAEA,UAAU,WAAiB;AACzB,UAAM,SAAS,IAAI,WAAU,EAAG,IAAI,aAAa,UAAU,SAAQ,CAAE;AACrE,WAAO,KAAK,KAAK,IAAa,GAAG,KAAK,MAAM,WAAW,EAAE,OAAM,CAAE;EACnE;;;;;EAMA,aAAa,WAAmB,UAAoB,SAAkB,YAAkB;AACtF,QAAI,SAAS,IAAI,WAAU,EACxB,IAAI,aAAa,UAAU,SAAQ,CAAE,EACrC,IAAI,WAAW,QAAQ,SAAQ,CAAE,EACjC,IAAI,cAAc,UAAU,EAC5B,IAAI,YAAY,SAAS,KAAK,GAAG,CAAC;AACrC,WAAO,KAAK,KAAK,IAA2B,GAAG,KAAK,MAAM,cAAc,EAAE,OAAM,CAAE;EACpF;;;;;EAMA,cAAc,QAAgB,SAA+F;AAC3H,WAAO,KAAK,KAAK,KAAqB,GAAG,KAAK,MAAM,WAAW,EAAE,QAAQ,QAAO,CAAE;EACpF;EAEA,iBAAc;AACZ,WAAO,KAAK,KAAK,IAAmB,GAAG,KAAK,MAAM,UAAU;EAC9D;EAEA,eAAe,QAAc;AAC3B,WAAO,KAAK,KAAK,IAAkB,GAAG,KAAK,MAAM,YAAY,MAAM,EAAE;EACvE;EACA,qBAAkB;AAChB,WAAO,KAAK,KAAK,IAAS,GAAG,KAAK,MAAM,qBAAqB;EACjE;EAEE,iBAAc;AACZ,WAAO,KAAK,KAAK,IAAW,GAAG,KAAK,MAAM,cAAc;EAC1D;EAEA,kBAAe;AACb,WAAO,KAAK,KAAK,IAAkB,GAAG,KAAK,MAAM,gBAAgB;EACnE;EAEA,oBAAiB;AACf,WAAO,KAAK,KAAK,IAAS,GAAG,KAAK,MAAM,kBAAkB;EAC5D;EAEA,uBAAuB,WAAmB,eAAqB;AAC7D,UAAM,SAAS,IAAI,WAAU,EAC1B,IAAI,aAAa,UAAU,SAAQ,CAAE,EACrC,IAAI,iBAAiB,cAAc,SAAQ,CAAE;AAChD,WAAO,KAAK,KAAK,IAAgC,GAAG,KAAK,MAAM,yBAAyB,EAAE,OAAM,CAAE;EACpG;;qCAhEW,cAAW,mBAAA,UAAA,CAAA;EAAA;4EAAX,cAAW,SAAX,aAAW,WAAA,YAFV,OAAM,CAAA;;;sEAEP,aAAW,CAAA;UAHvB;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
