import{a as me}from"./chunk-UUJUPXTB.js";import{b as W,c as G,d as $,e as U}from"./chunk-XF67VSU4.js";import{b as O,c as z}from"./chunk-MZQCBFKV.js";import{a as le,b as de}from"./chunk-X7KCC4V3.js";import{l as D}from"./chunk-GKJMT5CE.js";import{a as ie,b as ne}from"./chunk-KPCZ6BGT.js";import{a as re,b as se}from"./chunk-KD4OITAO.js";import{b as K,e as Y,g as Q,m as J,p as X,q as Z}from"./chunk-2QNRKEEY.js";import"./chunk-V3RLZPWU.js";import"./chunk-4O3FVBGX.js";import{a as ae,b as oe}from"./chunk-DUHWH566.js";import"./chunk-MAKQHRFT.js";import{c as B,d as j,g as L,h as N}from"./chunk-OVN2A4WB.js";import"./chunk-XEILQOEW.js";import{a as ee,b as te}from"./chunk-BK62AMNQ.js";import{Aa as h,Ea as H,k as M,l as R,p as A,r as V,wa as y}from"./chunk-IGLYEISI.js";import{$ as f,$a as u,Ab as d,Da as s,Mb as T,Oa as b,Ob as c,Pb as x,Qb as P,Sb as F,Tb as S,Ub as C,Va as k,Wb as w,Xb as I,_,dc as E,fc as q,lb as a,mb as n,nb as r,ob as p,vb as v,zb as g}from"./chunk-GHXVRSLK.js";var ue=()=>({width:"500px"});function _e(t,i){t&1&&c(0,"Arkada\u015Flar")}function fe(t,i){if(t&1&&p(0,"p-badge",17),t&2){let e=d(2);a("value",e.requests.length)}}function ge(t,i){t&1&&p(0,"p-progressSpinner")}function ve(t,i){if(t&1){let e=v();n(0,"li",22)(1,"div",23),p(2,"p-avatar",24),n(3,"span",25),c(4),r()(),n(5,"div",26)(6,"p-button",27),g("click",function(){let l=_(e).$implicit,m=d(4);return f(m.respondToRequest(l.id,"accept"))}),r(),n(7,"p-button",28),g("click",function(){let l=_(e).$implicit,m=d(4);return f(m.respondToRequest(l.id,"reject"))}),r()()()}if(t&2){let e=i.$implicit;s(2),a("image",e.profile_picture||"assets/images/avatar-placeholder.png"),s(2),x(e.username)}}function xe(t,i){if(t&1&&(n(0,"ul",20),u(1,ve,8,2,"li",21),r()),t&2){let e=d(3);s(),a("ngForOf",e.requests)}}function be(t,i){t&1&&(n(0,"div",29),p(1,"i",30),n(2,"p",31),c(3,"Yeni arkada\u015Fl\u0131k iste\u011Fin yok."),r()())}function ye(t,i){if(t&1&&(n(0,"div"),u(1,xe,2,1,"ul",18)(2,be,4,0,"div",19),r()),t&2){let e=d(2);s(),a("ngIf",e.requests.length>0),s(),a("ngIf",e.requests.length===0)}}function he(t,i){t&1&&p(0,"p-progressSpinner")}function Fe(t,i){if(t&1){let e=v();n(0,"div",34)(1,"div",35)(2,"div",36),g("click",function(){let l=_(e).$implicit,m=d(3);return f(m.showUserProfile(l.username))}),p(3,"p-avatar",24),n(4,"span",25),c(5),r()(),n(6,"p-button",37),g("click",function(l){let m=_(e).$implicit,ce=d(3);return f(ce.confirmRemoveFriend(l,m))}),r()()()}if(t&2){let e=i.$implicit;s(3),a("image",e.profile_picture||"assets/images/avatar-placeholder.png"),s(2),x(e.username)}}function Se(t,i){t&1&&(n(0,"div",38),p(1,"i",39),n(2,"p",31),c(3,"Hen\xFCz hi\xE7 arkada\u015F\u0131n yok."),r()())}function Ce(t,i){if(t&1&&(n(0,"div",7),u(1,Fe,7,2,"div",32)(2,Se,4,0,"div",33),r()),t&2){let e=d(2);s(),a("ngForOf",e.friends),s(),a("ngIf",e.friends.length===0)}}function ke(t,i){if(t&1){let e=v();n(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10)(4,"label",11),c(5,"Kullan\u0131c\u0131 Ad\u0131 ile Arkada\u015F Ekle"),r(),n(6,"input",12),C("ngModelChange",function(l){_(e);let m=d();return S(m.usernameToAdd,l)||(m.usernameToAdd=l),f(l)}),g("keyup.enter",function(){_(e);let l=d();return f(l.sendRequest())}),r()(),n(7,"p-button",13),g("click",function(l){_(e);let m=d();return f(m.confirmSendRequest(l))}),r()()(),n(8,"div",14)(9,"h5"),c(10,"Arkada\u015Fl\u0131k \u0130stekleri "),u(11,fe,1,1,"p-badge",15),r(),u(12,ge,1,0,"p-progressSpinner",5)(13,ye,3,2,"div",5),r()(),p(14,"p-divider"),n(15,"h5"),c(16,"Arkada\u015Flar\u0131m"),r(),u(17,he,1,0,"p-progressSpinner",5)(18,Ce,3,2,"div",16)}if(t&2){let e=d();s(6),F("ngModel",e.usernameToAdd),s(),a("disabled",!e.usernameToAdd.trim()),s(4),a("ngIf",e.requests.length>0),s(),a("ngIf",e.loadingRequests),s(),a("ngIf",!e.loadingRequests),s(4),a("ngIf",e.loadingFriends),s(),a("ngIf",!e.loadingFriends)}}function Te(t,i){t&1&&p(0,"p-progressSpinner")}function Pe(t,i){if(t&1){let e=v();n(0,"p-button",55),g("click",function(){_(e);let l=d(3);return f(l.sendRequestFromModal())}),r()}}function we(t,i){t&1&&p(0,"p-button",56),t&2&&a("disabled",!0)}function Ie(t,i){t&1&&p(0,"p-button",57),t&2&&a("disabled",!0)}function Ee(t,i){if(t&1&&(n(0,"div",51),u(1,Pe,1,0,"p-button",52)(2,we,1,1,"p-button",53)(3,Ie,1,1,"p-button",54),r()),t&2){let e=d(2);s(),a("ngIf",e.selectedProfile.friendshipStatus==="none"),s(),a("ngIf",e.selectedProfile.friendshipStatus==="pending"),s(),a("ngIf",e.selectedProfile.friendshipStatus==="accepted")}}function qe(t,i){if(t&1&&(n(0,"div"),p(1,"p-avatar",40),n(2,"h2",41),c(3),r(),n(4,"p",31),c(5),E(6,"date"),r(),u(7,Ee,4,3,"div",42),n(8,"p-divider",43)(9,"b"),c(10,"\u0130statistikler"),r()(),n(11,"div",44)(12,"div",45)(13,"div",46),p(14,"i",47),n(15,"div",48),c(16),r(),n(17,"div",49),c(18,"Toplam Puan"),r()()(),n(19,"div",45)(20,"div",46),p(21,"i",50),n(22,"div",48),c(23),r(),n(24,"div",49),c(25,"Tamamlanan Quiz"),r()()()()()),t&2){let e=d();s(),a("image",e.selectedProfile.user.profile_picture||"assets/images/avatar-placeholder.png"),s(2),x(e.selectedProfile.user.username),s(2),P("\xDCyelik Tarihi: ",q(6,6,e.selectedProfile.user.created_at,"dd.MM.yyyy")),s(2),a("ngIf",e.selectedProfile.friendshipStatus!=="self"),s(9),x(e.selectedProfile.stats.total_score),s(7),x(e.selectedProfile.stats.quizzes_completed)}}function Me(t,i){if(t&1){let e=v();n(0,"p-button",58),g("click",function(){_(e);let l=d();return f(l.displayProfileDialog=!1)}),r()}}var pe=class t{constructor(i,e,o){this.friendsService=i;this.messageService=e;this.confirmationService=o}friends=[];requests=[];usernameToAdd="";loadingFriends=!0;loadingRequests=!0;displayProfileDialog=!1;selectedProfile=null;loadingProfile=!1;ngOnInit(){this.loadFriends(),this.loadRequests()}loadFriends(){this.loadingFriends=!0,this.friendsService.getFriends().subscribe({next:i=>{this.friends=i,this.loadingFriends=!1},error:()=>{this.loadingFriends=!1,this.messageService.add({severity:"error",summary:"Hata",detail:"Arkada\u015Flar y\xFCklenemedi."})}})}loadRequests(){this.loadingRequests=!0,this.friendsService.getFriendRequests().subscribe({next:i=>{this.requests=i,this.loadingRequests=!1},error:()=>{this.loadingRequests=!1,this.messageService.add({severity:"error",summary:"Hata",detail:"\u0130stekler y\xFCklenemedi."})}})}sendRequest(){this.usernameToAdd.trim()&&this.friendsService.sendFriendRequest(this.usernameToAdd).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"Ba\u015Far\u0131l\u0131",detail:i.message}),this.usernameToAdd=""},error:i=>{this.messageService.add({severity:"error",summary:"Hata",detail:i.error.message||"\u0130stek g\xF6nderilemedi."})}})}respondToRequest(i,e){this.friendsService.respondToRequest(i,e).subscribe({next:o=>{this.messageService.add({severity:"success",summary:"Ba\u015Far\u0131l\u0131",detail:o.message}),this.loadRequests(),e==="accept"&&this.loadFriends()},error:o=>{this.messageService.add({severity:"error",summary:"Hata",detail:o.error.message||"\u0130\u015Flem ger\xE7ekle\u015Ftirilemedi."})}})}confirmSendRequest(i){this.usernameToAdd.trim()&&this.confirmationService.confirm({target:i.target,message:`"${this.usernameToAdd}" adl\u0131 kullan\u0131c\u0131ya arkada\u015Fl\u0131k iste\u011Fi g\xF6ndermek istedi\u011Fine emin misin?`,header:"\u0130ste\u011Fi Onayla",icon:"pi pi-send",acceptLabel:"Evet, G\xF6nder",rejectLabel:"Hay\u0131r",accept:()=>this.sendRequest()})}confirmRemoveFriend(i,e){this.confirmationService.confirm({target:i.target,message:`"${e.username}" art\u0131k arkada\u015F\u0131n olmayacak ve bu onu \xFCzebilir. Yine de arkada\u015Fl\u0131ktan \xE7\u0131karmak istedi\u011Fine emin misin?`,header:"Emin misin?",icon:"pi pi-heart-broken",acceptLabel:"Evet, \xC7\u0131kar",rejectLabel:"Hay\u0131r",accept:()=>{this.removeFriend(e.id)}})}removeFriend(i){this.friendsService.removeFriend(i).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Ba\u015Far\u0131l\u0131",detail:e.message}),this.loadFriends()},error:e=>this.messageService.add({severity:"error",summary:"Hata",detail:e.error.message||"Arkada\u015F silinemedi."})})}showUserProfile(i){this.loadingProfile=!0,this.displayProfileDialog=!0,this.selectedProfile=null,this.friendsService.getUserProfile(i).subscribe({next:e=>{this.selectedProfile=e,this.loadingProfile=!1},error:e=>{this.messageService.add({severity:"error",summary:"Hata",detail:e.error.message||"Profil y\xFCklenemedi."}),this.loadingProfile=!1,this.displayProfileDialog=!1}})}sendRequestFromModal(){this.selectedProfile?.user.username&&this.friendsService.sendFriendRequest(this.selectedProfile.user.username).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"Ba\u015Far\u0131l\u0131",detail:i.message}),this.selectedProfile&&(this.selectedProfile.friendshipStatus="pending")},error:i=>{this.messageService.add({severity:"error",summary:"Hata",detail:i.error.message||"\u0130stek g\xF6nderilemedi."})}})}static \u0275fac=function(e){return new(e||t)(b(me),b(h),b(y))};static \u0275cmp=k({type:t,selectors:[["app-friends"]],features:[w([h,y])],decls:11,vars:10,consts:[[1,"friends-page"],["pTemplate","title"],["pTemplate","content"],[3,"visibleChange","visible","modal","showHeader","draggable","resizable"],[1,"user-profile-modal","text-center","pt-4"],[4,"ngIf"],["pTemplate","footer"],[1,"grid"],[1,"col-12","md:col-4"],[1,"p-fluid"],[1,"field"],["for","username"],["id","username","type","text","pInputText","","placeholder","Arkada\u015F\u0131n\u0131n kullan\u0131c\u0131 ad\u0131n\u0131 gir",3,"ngModelChange","keyup.enter","ngModel"],["label","\u0130stek G\xF6nder","icon","pi pi-send",3,"click","disabled"],[1,"col-12","md:col-8"],["severity","danger",3,"value",4,"ngIf"],["class","grid",4,"ngIf"],["severity","danger",3,"value"],["class","list-none p-0 m-0",4,"ngIf"],["class","text-center p-5",4,"ngIf"],[1,"list-none","p-0","m-0"],["class","flex align-items-center justify-content-between p-3 mb-2 surface-100 border-round",4,"ngFor","ngForOf"],[1,"flex","align-items-center","justify-content-between","p-3","mb-2","surface-100","border-round"],[1,"flex","align-items-center"],["shape","circle","size","large",1,"mr-3",3,"image"],[1,"font-bold","text-lg"],[1,"flex","gap-2"],["icon","pi pi-check","styleClass","p-button-success p-button-rounded p-button-sm",3,"click"],["icon","pi pi-times","styleClass","p-button-danger p-button-rounded p-button-sm",3,"click"],[1,"text-center","p-5"],[1,"pi","pi-inbox","text-3xl","text-color-secondary","mb-3"],[1,"text-color-secondary"],["class","col-12 md:col-6 lg:col-4",4,"ngFor","ngForOf"],["class","col-12 text-center p-5",4,"ngIf"],[1,"col-12","md:col-6","lg:col-4"],[1,"friend-card","flex","align-items-center","justify-content-between","p-3","surface-100","border-round"],[1,"flex","align-items-center","no-underline","text-color","w-full","cursor-pointer",3,"click"],["icon","pi pi-user-minus","styleClass","p-button-danger p-button-rounded p-button-text","pTooltip","Arkada\u015Fl\u0131ktan \xC7\u0131kar",3,"click"],[1,"col-12","text-center","p-5"],[1,"pi","pi-users","text-3xl","text-color-secondary","mb-3"],["styleClass","w-9rem h-9rem mb-3","shape","circle",3,"image"],[1,"text-3xl","font-bold","mb-1"],["class","mt-4",4,"ngIf"],["layout","horizontal","align","center","styleClass","my-5"],[1,"grid","text-center"],[1,"col-6"],[1,"p-3"],[1,"pi","pi-star-fill","text-yellow-500","text-4xl","mb-2"],[1,"text-2xl","font-bold"],[1,"text-sm","text-color-secondary"],[1,"pi","pi-book","text-blue-500","text-4xl","mb-2"],[1,"mt-4"],["label","Arkada\u015F Ekle","icon","pi pi-user-plus",3,"click",4,"ngIf"],["label","\u0130stek G\xF6nderildi","icon","pi pi-clock","styleClass","p-button-secondary",3,"disabled",4,"ngIf"],["label","Arkada\u015Fs\u0131n\u0131z","icon","pi pi-users","styleClass","p-button-success",3,"disabled",4,"ngIf"],["label","Arkada\u015F Ekle","icon","pi pi-user-plus",3,"click"],["label","\u0130stek G\xF6nderildi","icon","pi pi-clock","styleClass","p-button-secondary",3,"disabled"],["label","Arkada\u015Fs\u0131n\u0131z","icon","pi pi-users","styleClass","p-button-success",3,"disabled"],["label","Kapat","icon","pi pi-times","styleClass","p-button-text",3,"click"]],template:function(e,o){e&1&&(p(0,"p-toast")(1,"p-confirmDialog"),n(2,"div",0)(3,"p-card"),u(4,_e,1,0,"ng-template",1)(5,ke,19,7,"ng-template",2),r()(),n(6,"p-dialog",3),C("visibleChange",function(m){return S(o.displayProfileDialog,m)||(o.displayProfileDialog=m),m}),n(7,"div",4),u(8,Te,1,0,"p-progressSpinner",5)(9,qe,26,9,"div",5),r(),u(10,Me,1,0,"ng-template",6),r()),e&2&&(s(6),T(I(9,ue)),F("visible",o.displayProfileDialog),a("modal",!0)("showHeader",!1)("draggable",!1)("resizable",!1),s(2),a("ngIf",o.loadingProfile),s(),a("ngIf",!o.loadingProfile&&o.selectedProfile))},dependencies:[V,M,R,J,K,Y,Q,D,te,ee,H,N,L,Z,X,ne,ie,se,re,z,O,j,B,oe,ae,U,$,de,le,G,W,A],styles:["[_nghost-%COMP%]     .p-badge.p-badge-danger{animation:pulse 1.5s infinite}.friend-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:none;background-color:var(--surface-200);border-radius:var(--border-radius)}"]})};export{pe as FriendsComponent};
